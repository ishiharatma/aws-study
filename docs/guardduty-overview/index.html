
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Amazon GuardDuty</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/claat-public/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="G-01ZZ95D1K9"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="guardduty-overview"
                  title="Amazon GuardDuty"
                  environment="web"
                  feedback-link="">
    
      <google-codelab-step label="☘️ はじめに" duration="0">
        <p>本ページは、AWS に関する個人の勉強および勉強会で使用することを目的に、AWS ドキュメントなどを参照し作成しておりますが、記載の誤り等が含まれる場合がございます。</p>
<p>最新の情報については、AWS 公式ドキュメントをご参照ください。</p>


      </google-codelab-step>
    
      <google-codelab-step label="👀 Contents" duration="1">
        <ul>
<li><a href="#guardduty-%E3%81%A8%E3%81%AF" target="_blank">GuardDuty とは</a></li>
<li><a href="#guardduty-%E3%81%8C%E5%BF%85%E8%A6%81%E3%81%AA%E7%90%86%E7%94%B1" target="_blank">GuardDuty が必要な理由</a></li>
<li><a href="#%E7%89%B9%E5%BE%B4" target="_blank">特徴</a></li>
<li><a href="#%E5%85%A8%E3%83%AA%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%A7%E6%9C%89%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B%E3%81%AB%E3%81%AF" target="_blank">全リージョンで有効化するには</a></li>
<li><a href="#%E8%84%85%E5%A8%81%E6%A4%9C%E5%87%BA" target="_blank">脅威検出</a></li>
<li><a href="#%E6%A4%9C%E5%87%BA%E7%B5%90%E6%9E%9C%E3%82%BF%E3%82%A4%E3%83%97" target="_blank">検出結果タイプ</a><ul>
<li><a href="#%E4%BF%A1%E9%A0%BC%E3%81%8A%E3%82%88%E3%81%B3%E8%84%85%E5%A8%81-ip-%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E3%83%AA%E3%82%B9%E3%83%88" target="_blank">信頼および脅威 IP アドレスリスト</a></li>
</ul>
</li>
<li><a href="#%E3%83%9E%E3%83%AB%E3%82%A6%E3%82%A7%E3%82%A2%E6%A4%9C%E7%9F%A5" target="_blank">マルウェア検知</a><ul>
<li><a href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85" target="_blank">注意事項</a></li>
</ul>
</li>
<li><a href="#%E6%A4%9C%E5%87%BA%E7%B5%90%E6%9E%9C%E9%80%9A%E7%9F%A5" target="_blank">検出結果通知</a></li>
<li><a href="#%E6%A4%9C%E5%87%BA%E7%B5%90%E6%9E%9C%E3%81%AE%E7%A2%BA%E8%AA%8D" target="_blank">検出結果の確認</a></li>
<li><a href="#%E8%A4%87%E6%95%B0%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%AE%E7%AE%A1%E7%90%86" target="_blank">複数アカウントの管理</a></li>
<li><a href="#-%E3%81%BE%E3%81%A8%E3%82%81" target="_blank">📖 まとめ</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="GuardDuty とは" duration="47">
        <p>AWS 環境のセキュリティを継続的にチェックしてくれるサービスです。</p>
<p>【AWS Black Belt Online Seminar】<a href="https://youtu.be/Tb2Uw4B_Ihw" target="_blank">Amazon GuardDuty(YouTube)</a>(0:46:52)</p>
<p class="image-container"><img alt="blackbelt-guardduty" src="img\\470e4a520fb45766.jpg"></p>
<p>【AWS Black Belt Online Seminar】<a href="https://youtu.be/GwzBiO1jBvU" target="_blank">Amazon GuardDuty Malware Protection(YouTube)</a>(0:43:53)</p>
<p class="image-container"><img alt="blackbelt-guardduty-malware" src="img\\5f96981244faefca.jpg"></p>
<p><a href="https://aws.amazon.com/jp/guardduty/" target="_blank">Amazon GuardDuty サービス概要</a></p>
<p><a href="https://docs.aws.amazon.com/ja_jp/guardduty/?id=docs_gateway" target="_blank">Amazon GuardDuty ドキュメント</a></p>
<p><a href="https://aws.amazon.com/jp/guardduty/faqs/" target="_blank">Amazon GuardDuty よくある質問</a></p>
<p><a href="https://aws.amazon.com/jp/guardduty/pricing/" target="_blank">Amazon GuardDuty の料金</a></p>


      </google-codelab-step>
    
      <google-codelab-step label="GuardDuty が必要な理由" duration="2">
        <p>Well-Architected フレームワークという考え方のうち、「<a href="https://docs.aws.amazon.com/ja_jp/wellarchitected/latest/framework/security.html" target="_blank">セキュリティの柱</a>」に、「<a href="https://docs.aws.amazon.com/ja_jp/wellarchitected/latest/framework/sec-detection.html" target="_blank">発見的統制</a>」というものがあります。</p>
<p>これは、セキュリティインシデントが発生しても通知するようにしておき対応する、というものです。</p>
<p>自力で検知を組み込むのは大変な事ですが、これを自動的に検知して通知してくれるのが Amazon GuardDuty ですので、有効化しておくとよいです。</p>


      </google-codelab-step>
    
      <google-codelab-step label="特徴" duration="1">
        <ul>
<li>30 日間は無料</li>
<li>AWS アカウントレベルで検出</li>
<li>GuardDuty はリージョンサービス</li>
<li>全てのリージョンで有効化することを推奨 <ul>
<li>全リージョンで有効化するには、CLI や CDK などで効率化する</li>
</ul>
</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="全リージョンで有効化するには" duration="0">
        <p>AWS CLI を使う場合</p>
<pre><code language="language-sh" class="language-sh">#!/usr/bin/sh
# リージョン一覧の取得
REGIONS=$( \
    aws ec2 describe-regions \
        --all-regions \
        --query &#34;Regions[].RegionName&#34; \
        --output text \
        --profile ${profileName} \
    )
for region in ${REGIONS[@]}; do
  # 有効化の確認
  DETECTOR=$( ¥
        aws guardduty list-detectors \
        --region &#34;${REGION}&#34; \
        --query DetectorIds \
        --output text \
        )
  if [ &#34;${#DETECTOR}&#34; -ne &#34;0&#34; ] ; then
      # 既に有効化されている
      echo &#34;GuardDuty is already enabled. ${REGION}:${DETECTOR}&#34;
  else
      # finding-publishing-frequency は指定しないとデフォルト 6h
      aws guardduty create-detector \
        --region &#34;${REGION}&#34; \
        --finding-publishing-frequency FIFTEEN_MINUTES \
        --enable \
        --profile ${profileName}
  fi
done
</code></pre>
<p>AWS CDK を使う場合</p>
<pre><code language="language-ts" class="language-ts"># YAML のパラメータファイルに以下を定義
# import * as yaml from &#39;js-yaml&#39;; で読み込んでいます。
# ---------
# ForceEnabled : true # それぞれの設定に関係なく強制的に有効化する場合 true
# RegionConfigs :
#  -  { Region: &#39;us-east-1&#39; , isEnabled: false } # 米国東部（バージニア北部）
#  -  { Region: &#39;us-east-2&#39; , isEnabled: false } # 米国東部 (オハイオ)
#  -  { Region: &#39;us-west-1&#39; , isEnabled: false } # 米国西部 (北カリフォルニア)
#  :

RegionConfigs.forEach((x) =&gt; {
  if (x.isEnabled || isForceEnabled) {
    new GuardDutyStack(app, `GuardDutyStack${x.Region}`, {
      :
      :
      env : {
        account: process.env.CDK_DEFAULT_ACCOUNT,
        region: x.Region,
      }
    }
  }
}
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="脅威検出" duration="1">
        <p>ログなどから脅威を検出する機能です。検出する機能なので、通知するには EventBridge と SNS を利用する必要があります。（<a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_findings_cloudwatch.html#guardduty_cloudwatch_severity_notification" target="_blank">GuardDuty の検出結果を通知する CloudWatch Events ルールの作成</a>）</p>
<p>検出結果 <img alt="result" src="img\\7b35604db9576098.png"><img alt="result-detail" src="img\\fb2ce7835e7018f3.png"></p>
<p>EventBridge のイベントパターン指定例 <img alt="event-pattern" src="img\\72685c3784307bc1.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="検出結果タイプ" duration="2">
        <p>GuardDuty を有効化したときにデフォルトで次のログを検査します。CloudTrail の有効化や VPC Flow logs や DNS ログの設定がされていなくても GuardDuty によって個別に取得されます。 ただし、調査などの理由から各サービスのログも有効化しておくのを推奨します。</p>
<ul>
<li><a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_data-sources.html#guardduty_cloudtrail" target="_blank">AWS CloudTrail イベントログ</a></li>
<li><a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_data-sources.html#guardduty_controlplane" target="_blank">AWS CloudTrail 管理イベント</a></li>
<li><a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_data-sources.html#guardduty_vpc" target="_blank">VPC Flow Logs</a></li>
<li><a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_data-sources.html#guardduty_dns" target="_blank">DNS ログ</a></li>
</ul>
<p>これ以外に、個別のサービスに対するモニタリングを有効／無効にすることができます。詳細は <a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_finding-types-active.html" target="_blank">検出結果タイプ</a> を参照してください。</p>
<ul>
<li>EKS Protection</li>
<li>Lambda Protection</li>
<li>RDS Protection</li>
<li>S3 Protection</li>
</ul>
<p class="image-container"><img alt="plan" src="img\\98595d73c89ec22c.png"></p>
<h2 is-upgraded>信頼および脅威 IP アドレスリスト</h2>
<p><a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_upload-lists.html" target="_blank">信頼できる IP リストと 脅威リストの使用</a></p>
<p>IP アドレスまたは CIDR によって脅威の検出を制御できます。</p>
<ul>
<li>信頼されている IP リスト(Trusted IP lists) <ul>
<li>このリストに指定したものを脅威として検出しなくなります。セキュリティテストを行うサーバの IP を指定しておくといったケースが考えられます。</li>
</ul>
</li>
<li>脅威 IP リスト(Threat IP lists) <ul>
<li>既にある AWS の脅威リストを補完するもので、ユーザーが個別に指定できます。</li>
</ul>
</li>
</ul>
<p class="image-container"><img alt="ip-list" src="img\\92e5fa10dfaf15f1.png"></p>
<p>信頼と脅威に同じものを指定した場合は、信頼リストのほうの判定が優先され、脅威対象と見なされなくなるので注意が必要です。</p>


      </google-codelab-step>
    
      <google-codelab-step label="マルウェア検知" duration="3">
        <p>インスタンスで動作しているマルウェアを検出できます。 通常、サードパーティ製のマルウェア検知ソフトの場合、インスタンスにエージェントをインストールしなければならないが、GuardDuty を使えばエージェントレスでマルウェアを検知できます。 チェック対象の EC2 にアタッチされた EBS はスナップショットが取得され、そのスナップショットから、DuardDuty が動作する 別の AWS アカウントに EBS が複製され、チェックを実行する　 EC2 にアタッチされて検査されます。</p>
<p class="image-container"><img alt="malware-scan" src="img\\35e9ff7f9130d476.png"></p>
<p>このため、チェック対象のインスタンスにエージェントのインストールが不要になります。</p>
<p>スキャンの方法は 2 種類あります。</p>
<ul>
<li><a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/gdu-initiated-malware-scan.html" target="_blank">実行型マルウェアスキャン</a><ul>
<li>GuardDuty の脅威検出でマルウェアの動作を検知した後にスキャンが実行されます。 <ul>
<li><a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/gd-findings-initiate-malware-protection-scan.html" target="_blank">GuardDuty 実行型マルウェアスキャンを起動する検出結果</a></li>
<li>上記を検出後、前回から 24 時間に 1 回実行されます。</li>
</ul>
</li>
</ul>
</li>
<li><a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/on-demand-malware-scan.html" target="_blank">オンデマンドスキャン</a><ul>
<li>GuardDuty の結果に関係なくスキャンを実行できます。</li>
<li>前回実行から 1 時間経過している必要があります。</li>
<li>ただし、無料期間中は実施できません。</li>
</ul>
</li>
</ul>
<h2 is-upgraded>注意事項</h2>
<ul>
<li>現時点では「スキャンはするが保護、隔離などは実施しない」ので、簡易的なチェックです。Deep Security や Cloud One などのように予防的な対策を行ってくれるものではありません。</li>
<li>スキャン実施時に、一時的とはいえ別の AWS アカウントに EBS が複製されます。スキャン対象の EBS に機密データが含まれるような場合、利用可否をしっかり検討してください。</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="検出結果通知" duration="5">
        <p>検出結果通知は、GuardDuty から Amazon EventBridge に発信されるイベントを検出し、SNS と連携することで実現できます。</p>
<p>GuardDuty から 発信される <a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_findings-summary.html" target="_blank">検出結果の詳細</a> は次のようになります。</p>
<pre><code language="language-json" class="language-json">        {
         &#34;version&#34;: &#34;0&#34;,
         &#34;id&#34;: &#34;cd2d702e-ab31-411b-9344-793ce56b1bc7&#34;,
         &#34;detail-type&#34;: &#34;GuardDuty Finding&#34;,
         &#34;source&#34;: &#34;aws.guardduty&#34;,
         &#34;account&#34;: &#34;111122223333&#34;,
         &#34;time&#34;: &#34;1970-01-01T00:00:00Z&#34;,
         &#34;region&#34;: &#34;us-east-1&#34;,
         &#34;resources&#34;: [],
         &#34;detail&#34;: {GUARDDUTY_FINDING_JSON_OBJECT}
        }
</code></pre>
<p>上記のようなイベントを検出できるように、EventBridge の<a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_findings_cloudwatch.html#guardduty_findings_cloudwatch_format" target="_blank">イベントパターン</a>を定義します。定義の雛形は次のとおりです。</p>
<pre><code language="language-json" class="language-json">{
  &#34;source&#34;: [
    &#34;aws.guardduty&#34;
  ],
  &#34;detail-type&#34;: [
    &#34;GuardDuty Finding&#34;
  ],
  &#34;detail&#34;: {
    &#34;severity&#34;: [
      :
    ]
  }
}
</code></pre>
<p>通知対象を限定せずに設定を行うと大量のメールが送信される可能性があるため注意が必要です。</p>
<p>[Medium] (中)〜[High] (高) を検出するイベントパターンの例は次のとおりです。</p>
<pre><code language="language-json" class="language-json">{
  &#34;source&#34;: [&#34;aws.guardduty&#34;],
  &#34;detail-type&#34;: [&#34;GuardDuty Finding&#34;],
  &#34;detail&#34;: {
    &#34;severity&#34;: [
      4, 4.0, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5, 5.0, 5.1, 5.2,
      5.3, 5.4, 5.5, 5.6, 5.7, 5.8, 5.9, 6, 6.0, 6.1, 6.2, 6.3, 6.4, 6.5, 6.6,
      6.7, 6.8, 6.9, 7, 7.0, 7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 7.7, 7.8, 7.9, 8,
      8.0, 8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8, 8.9
    ]
  }
}
</code></pre>
<p>severity は GuardDuty で定義されている重要度レベルを示しており、数値と重要度は以下の通りです。</p>
<ul>
<li>高： 7.0〜8.9 の範囲</li>
<li>中： 4.0〜6.9 の範囲</li>
<li>低： 0.1〜3.9 の範囲</li>
</ul>
<p>または、次のようにも定義できます。</p>
<pre><code language="language-json" class="language-json">{
  &#34;source&#34;: [&#34;aws.guardduty&#34;],
  &#34;detail-type&#34;: [&#34;GuardDuty Finding&#34;],
  &#34;detail&#34;: {
    &#34;severity&#34;: [{ &#34;numeric&#34;: [&#34;&gt;=&#34;, 4] }]
  }
}
</code></pre>
<p>このまま通知すると、JSON 形式の可読性の低いものになりますので、<a href="https://docs.aws.amazon.com/ja_jp/eventbridge/latest/userguide/eb-transform-target-input.html" target="_blank">インプットトランスフォーマー</a>機能をつかって、整形します。</p>
<p class="image-container"><img alt="transform-target-input" src="img\\277f2b175dcfba60.png"></p>
<p>&#34;入力パス&#34; で定義する項目は、次を参考にします。</p>
<ul>
<li><a href="https://docs.aws.amazon.com/ja_jp/securityhub/latest/userguide/securityhub-findings-format-syntax.html" target="_blank">AWS Security Finding 形式</a></li>
<li><a href="https://docs.aws.amazon.com/ja_jp/securityhub/latest/userguide/asff-required-attributes.html" target="_blank">必須属性</a></li>
<li><a href="https://docs.aws.amazon.com/ja_jp/securityhub/latest/userguide/asff-top-level-attributes.html" target="_blank">オプションの最上位属性</a></li>
</ul>
<p>入力パス</p>
<pre><code language="language-json" class="language-json">{
  &#34;severity&#34;: &#34;$.detail.severity&#34;,
  &#34;Account_ID&#34;: &#34;$.detail.accountId&#34;,
  &#34;Finding_ID&#34;: &#34;$.detail.id&#34;,
  &#34;Finding_Type&#34;: &#34;$.detail.type&#34;,
  &#34;region&#34;: &#34;$.region&#34;,
  &#34;Finding_description&#34;: &#34;$.detail.description&#34;
}
</code></pre>
<p>入力テンプレート</p>
<pre><code language="language-text" class="language-text">&#34;AWS &lt;Account_ID&gt; has a severity &lt;severity&gt; GuardDuty finding type &lt;Finding_Type&gt; in the &lt;region&gt; region.&#34;
&#34;Finding Description:&#34;
&#34;&lt;Finding_description&gt;. &#34;
&#34;For more details open the GuardDuty console at https://console.aws.amazon.com/guardduty/home?region=&lt;region&gt;#/findings?search=id%3D&lt;Finding_ID&gt;&#34;
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="検出結果の確認" duration="0">
        <p>通知のテストを行うために、サンプルイベントの発行機能があります。GuardDuty のコンソールから実行することでサンプルイベントを発行できます。</p>
<p><a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/sample_findings.html" target="_blank">GuardDuty のサンプルの検出結果生成</a></p>
<p class="image-container"><img alt="result-sample" src="img\\87c8cd8435a4f113.png"></p>
<p>サンプルが簡単に生成できるのは便利ですが、様々な<a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_finding-types-active.html" target="_blank">検出結果タイプ</a>のサンプルイベントを生成するため、通知が大量に配信されます。</p>
<p>AWS CLI を使うことで 1 件ずつイベントを発行できます。</p>
<pre><code language="language-sh" class="language-sh"># 重要度「高」
# EC2 インスタンスが、TCP ポートで UDP プロトコルを使用したサービス拒否 (DoS) 攻撃の実行に利用されている可能性があります。
# https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_finding-types-ec2.html#backdoor-ec2-denialofserviceudpontcpports
aws guardduty create-sample-findings \
--detector-id $(aws guardduty list-detectors --query &#39;DetectorIds&#39; --output text) \
--finding-types Backdoor:EC2/DenialOfService.UdpOnTcpPorts
# 重要度「中」
# EC2 インスタンスがポート 25 でリモートホストと通信して異常な動作を示しています
# https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_finding-types-ec2.html#backdoor-ec2-spambot
aws guardduty create-sample-findings \
  --detector-id $(aws guardduty list-detectors --query &#39;DetectorIds[0]&#39; --output text) \
  --finding-types &#34;Backdoor:EC2/Spambot&#34;
# 重要度「低」
# EC2 インスタンスが SSH ブルートフォース攻撃に巻き込まれています。
# https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_finding-types-ec2.html#unauthorizedaccess-ec2-sshbruteforce
aws guardduty create-sample-findings \
  --detector-id $(aws guardduty list-detectors --query &#39;DetectorIds[0]&#39; --output text) \
  --finding-types &#34;UnauthorizedAccess:EC2/SSHBruteForce&#34;
</code></pre>
<p>全てのリージョンの場合は、リージョンのリストを取得してから実施します。</p>
<pre><code language="language-sh" class="language-sh">aws ec2 describe-regions --query &#34;Regions[].[RegionName]&#34; --output text \
| while read region; do
aws guardduty create-sample-findings \
  --detector-id $(aws guardduty list-detectors --region ${region} --query &#39;DetectorIds[0]&#39; --output text) \
  --finding-types &#34;UnauthorizedAccess:EC2/SSHBruteForce&#34;
done
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="複数アカウントの管理" duration="2">
        <p><a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_accounts.html" target="_blank">Amazon GuardDuty での複数のアカウントの管理</a></p>
<p>結果を集約したい管理者アカウントでメンバーアカウントを招待することで、権威結果を表示することができます。</p>
<p>メンバーアカウントの管理は次の２つがあります。</p>
<ul>
<li><a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_invitations.html" target="_blank">招待による GuardDuty アカウントの管理</a></li>
<li><a href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/guardduty_organizations.html" target="_blank">AWS Organizations を使用した GuardDuty アカウントの管理</a></li>
</ul>
<p class="image-container"><img alt="account" src="img\\97ce3e3762168574.png"></p>
<p>メンバーアカウントを追加した場合、EventBridge が次のような設定だと管理者アカウントとメンバーアカウントの両方の検出結果が通知されます。</p>
<pre><code language="language-json" class="language-json">{
  &#34;source&#34;: [&#34;aws.guardduty&#34;],
  &#34;detail-type&#34;: [&#34;GuardDuty Finding&#34;],
  &#34;detail&#34;: {
    &#34;severity&#34;: [{ &#34;numeric&#34;: [&#34;&gt;=&#34;, 4] }]
  }
}
</code></pre>
<p>メンバーアカウントのアカウント ID を追加することでフィルタリングすることができます。</p>
<pre><code language="language-json" class="language-json">{
  &#34;source&#34;: [&#34;aws.guardduty&#34;],
  &#34;detail-type&#34;: [&#34;GuardDuty Finding&#34;],
  &#34;detail&#34;: {
    &#34;accountId&#34;: [&#34;123456789012&#34;],
    &#34;severity&#34;: [{ &#34;numeric&#34;: [&#34;&gt;=&#34;, 4] }]
  }
}
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="📖 まとめ" duration="0">
        <p class="image-container"><img alt="guardduty" src="img\\f7ab9b5631da725d.png"></p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/claat-public/native-shim.js"></script>
  <script src="https://storage.googleapis.com/claat-public/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/claat-public/prettify.js"></script>
  <script src="https://storage.googleapis.com/claat-public/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
