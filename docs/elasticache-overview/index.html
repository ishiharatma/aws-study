
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Amazon ElastiCache</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/claat-public/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="G-01ZZ95D1K9"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="elasticache-overview"
                  title="Amazon ElastiCache"
                  environment="web"
                  feedback-link="">
    
      <google-codelab-step label="☘️ はじめに" duration="0">
        <p>本ページは、AWS に関する個人の勉強および勉強会で使用することを目的に、AWS ドキュメントなどを参照し作成しておりますが、記載の誤り等が含まれる場合がございます。</p>
<p>最新の情報については、AWS 公式ドキュメントをご参照ください。</p>


      </google-codelab-step>
    
      <google-codelab-step label="👀 Contents" duration="0">
        <ul>
<li><a href="#amazon-elasticache" target="_blank">Amazon ElastiCache</a><ul>
<li><a href="#%EF%B8%8F-%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB" target="_blank">☘️ はじめに</a></li>
<li><a href="#-contents" target="_blank">👀 Contents</a></li>
<li><a href="#amazon-elasticache-%E3%81%A8%E3%81%AF" target="_blank">Amazon ElastiCache とは</a><ul>
<li><a href="#%E3%83%8F%E3%83%B3%E3%82%BA%E3%82%AA%E3%83%B3" target="_blank">ハンズオン</a></li>
</ul>
</li>
<li><a href="#memcached-%E3%81%A8-redis-%E3%81%AE%E6%AF%94%E8%BC%83" target="_blank">Memcached と Redis の比較</a></li>
<li><a href="#%E3%81%A9%E3%81%AE%E3%82%88%E3%81%86%E3%81%AB%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%82%89%E3%82%88%E3%81%84%E3%81%8B" target="_blank">どのように利用したらよいか？</a></li>
<li><a href="#dynamodb-%E3%81%A7%E4%BB%A3%E7%94%A8%E3%81%A7%E3%81%8D%E3%82%8B" target="_blank">DynamoDB で代用できる？</a></li>
<li><a href="#amazon-elasticache-for-memcached" target="_blank">Amazon ElastiCache for Memcached</a></li>
<li><a href="#amazon-elasticache-for-redis" target="_blank">Amazon ElastiCache for Redis</a></li>
<li><a href="#%E8%87%AA%E5%8B%95%E3%83%95%E3%82%A7%E3%82%A4%E3%83%AB%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC" target="_blank">自動フェイルオーバー</a></li>
<li><a href="#amazon-elasticache-for-redis-%E3%81%AE-global-datastore" target="_blank">Amazon ElastiCache for Redis の Global Datastore</a></li>
<li><a href="#-%E3%81%BE%E3%81%A8%E3%82%81" target="_blank">📖 まとめ</a></li>
</ul>
</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Amazon ElastiCache とは" duration="220">
        <p>フルマネージドのインメモリキャッシングサービスで、Memcached または Redis プロトコルに互換性があります。</p>
<p>【AWS Black Belt Online Seminar】<a href="https://www.youtube.com/watch?v=-NU1U8_fxo4" target="_blank">Amazon ElastiCache(YouTube)</a>(39:21)</p>
<p class="image-container"><img alt="blackbelt-elasticache" src="img\\7ab03c476a884761.jpg"></p>
<p>古い資料（PDF）はこちら<a href="https://d1.awsstatic.com/webinars/jp/pdf/services/20171214_AWS-Blackbelt-ElastiCache.pdf" target="_blank">【AWS Black Belt Online Seminar】 Amazon ElastiCache-2017.12.14</a></p>
<p class="image-container"><img alt="blackbelt-elasticache-2017-320.jpg" src="img\\1d03ba0898809e62.jpg"></p>
<p><a href="https://aws.amazon.com/jp/xx/" target="_blank">Amazon ElastiCache サービス概要</a></p>
<p><a href="https://docs.aws.amazon.com/ja_jp/elasticache/?icmpid=docs_homepage_databases" target="_blank">Amazon ElastiCache ドキュメント</a></p>
<p><a href="https://aws.amazon.com/jp/elasticache/faqs/" target="_blank">Amazon ElastiCache よくある質問</a></p>
<p><a href="https://aws.amazon.com/jp/elasticache/pricing/" target="_blank">Amazon ElastiCache 料金</a></p>
<p><a href="https://redis.io/" target="_blank">Redis</a></p>
<p>レディス と読みます。</p>
<p><a href="http://memcached.org/" target="_blank">Memcached</a></p>
<p>memory cache daemon の略でメムキャッシュディーと読みます｡</p>
<h2 is-upgraded>ハンズオン</h2>
<p><a href="https://aws.amazon.com/jp/getting-started/hands-on/real-time-leaderboard-amazon-aurora-serverless-elasticache/?trk=gs_card" target="_blank">Amazon Aurora Serverless と Amazon ElastiCache を使用してリアルタイムなリーダーボードをビルドする</a></p>
<p><a href="https://aws.amazon.com/jp/getting-started/hands-on/building-fast-session-caching-with-amazon-elasticache-for-redis/" target="_blank">Amazon ElastiCache for Redis を使い、オンラインアプリケーション用の高速セッションストアを構築する</a>(※英語のみ)</p>
<p><a href="https://aws.amazon.com/jp/getting-started/hands-on/boosting-mysql-database-performance-with-amazon-elasticache-for-redis/" target="_blank">Amazon ElastiCache for Redis を使い、MySQL データベースのパフォーマンスを向上させる</a>(※英語のみ)</p>
<p><a href="https://docs.aws.amazon.com/ja_jp/AmazonElastiCache/latest/red-ug/Tutorials.html#tutorial-videos" target="_blank">ElastiCache のチュートリアルと動画</a></p>


      </google-codelab-step>
    
      <google-codelab-step label="Memcached と Redis の比較" duration="2">
        <p>https://docs.aws.amazon.com/ja_jp/AmazonElastiCache/latest/red-ug/SelectEngine.html</p>
<p>主な比較は次のとおりです。</p>
<table>
<tr><td colspan="1" rowspan="1"><p>key</p>
</td><td colspan="1" rowspan="1"><p>Memcached</p>
</td><td colspan="1" rowspan="1"><p>Redis</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>マルチスレッド</p>
</td><td colspan="1" rowspan="1"><p>Yes</p>
</td><td colspan="1" rowspan="1"><p>No</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>データ型</p>
</td><td colspan="1" rowspan="1"><p>シンプル</p>
</td><td colspan="1" rowspan="1"><p>複雑</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>自動フェイルオーバー</p>
</td><td colspan="1" rowspan="1"><p>No</p>
</td><td colspan="1" rowspan="1"><p>Yes</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>レプリケーション</p>
</td><td colspan="1" rowspan="1"><p>No</p>
</td><td colspan="1" rowspan="1"><p>Yes</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>バックアップと復元</p>
</td><td colspan="1" rowspan="1"><p>No</p>
</td><td colspan="1" rowspan="1"><p>Yes</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Pub/Sub</p>
</td><td colspan="1" rowspan="1"><p>No</p>
</td><td colspan="1" rowspan="1"><p>Yes</p>
</td></tr>
</table>
<p>Memcached のほうが単純な Key-Value の処理だとパフォーマンスが優れるが、レプリケーション／自動フェイルオーバー／複雑な集計などが必要な場合は Redis を選択するケースが多くなると思います。</p>
<p>こちらにも詳しく記載があります。 https://aws.amazon.com/jp/elasticache/redis-vs-memcached/</p>


      </google-codelab-step>
    
      <google-codelab-step label="どのように利用したらよいか？" duration="2">
        <ul>
<li>キャッシュは揮発性のあるデータであるため、消えて困るデータは保存しないほうがよいです。 -結果整合性（分散データベース環境でデータが更新された際に、一定時間経過後には最終的な一貫性が担保されること）を前提とした設計を行う必要があります。</li>
<li>TTL（Time to Live, 有効期限）を設定しましょう。データを保存しすぎて、メモリが溢れてしまうといったことが発生します。TTL は長すぎても TTL が切れる前にメモリが溢れることにもなります。また、TTL が切れるタイミングが同じデータが多く存在すると、CPU 使用率が上昇することがあります。</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="DynamoDB で代用できる？" duration="2">
        <p>DynamoDB も Key-Value で低レイテンシーのサービスです。同じように代用もできるのではないかと考えます。 ただ、DynamoDB は可用性担保のため複数 AZ に保存しているので書き込みは遅くなります。また、DynamoDB はリクエスト数で課金されるため、頻繁に利用されるセッション情報などの場合はコストが急増したり、キャパシティが枯渇する可能性があります。DAX を利用することでこれらを回避することも出来ます。</p>
<p>つまり、基本的には永続化が不要であれば ElastiCache のほうがよいケースが多いと思われます。</p>


      </google-codelab-step>
    
      <google-codelab-step label="Amazon ElastiCache for Memcached" duration="2">
        <p>構成イメージはこのようになります。クラスタ化されていますが、レプリケーションの機能はありません。 <img alt="Redis Cluster/Replication" src="img\\2941a7c03219dc39.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Amazon ElastiCache for Redis" duration="3">
        <p>クラスタモード有効/無効　 × 　レプリケーション有/無のパターンがあります。 クラスタモードは複数のシャードにデータを分散させることが出来ます。クラスタモードが有効でもシャードを１つに設定することも可能です。</p>
<p>クラスタもレプリケーションもない単一の構成です。 <img alt="Redis NonCluster/NonReplication" src="img\\94fedb0e6cba1c5a.png"></p>
<p>レプリケーションが有効な構成です。 <img alt="Redis NonCluster/Replication" src="img\\21068385bc1e93fc.png"></p>
<p>クラスタモードが有効ですが、レプリケーション無しの構成です。 <img alt="Redis Cluster/NonReplication" src="img\\5ef4b53b04c9e070.png"></p>
<p>クラスタモードが有効でレプリケーション有りの構成です。 <img alt="Redis Cluster/Replication" src="img\\cf5715169ff1df56.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="自動フェイルオーバー" duration="1">
        <p>https://docs.aws.amazon.com/ja_jp/AmazonElastiCache/latest/red-ug/AutoFailover.html</p>
<p>レプリケーションされている場合、自動的にフェイルオーバーが実行されます。</p>


      </google-codelab-step>
    
      <google-codelab-step label="Amazon ElastiCache for Redis の Global Datastore" duration="1">
        <p>https://docs.aws.amazon.com/ja_jp/AmazonElastiCache/latest/red-ug/Redis-Global-Datastore.html</p>
<p class="image-container"><img alt="globaldatastore" src="img\\771cb580337dceaa.png"></p>
<p>Global Datastore for Redis 機能を使用すると、AWS リージョン全体で完全マネージド型、高速、信頼性、安全なレプリケーションを実行できます。</p>


      </google-codelab-step>
    
      <google-codelab-step label="📖 まとめ" duration="0">
        <p class="image-container"><img alt="elasticache" src="img\\16825857c0f78e6e.png"></p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/claat-public/native-shim.js"></script>
  <script src="https://storage.googleapis.com/claat-public/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/claat-public/prettify.js"></script>
  <script src="https://storage.googleapis.com/claat-public/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
