
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>AWS CDK</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/claat-public/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="G-01ZZ95D1K9"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="cdk-overview"
                  title="AWS CDK"
                  environment="web"
                  feedback-link="">
    
      <google-codelab-step label="â˜˜ï¸ ã¯ã˜ã‚ã«" duration="0">
        <p>æœ¬ãƒšãƒ¼ã‚¸ã¯ã€AWS ã«é–¢ã™ã‚‹å€‹äººã®å‹‰å¼·ãŠã‚ˆã³å‹‰å¼·ä¼šã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã«ã€AWS ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãªã©ã‚’å‚ç…§ã—ä½œæˆã—ã¦ãŠã‚Šã¾ã™ãŒã€è¨˜è¼‰ã®èª¤ã‚Šç­‰ãŒå«ã¾ã‚Œã‚‹å ´åˆãŒã”ã–ã„ã¾ã™ã€‚</p>
<p>æœ€æ–°ã®æƒ…å ±ã«ã¤ã„ã¦ã¯ã€AWS å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã”å‚ç…§ãã ã•ã„ã€‚</p>


      </google-codelab-step>
    
      <google-codelab-step label="ğŸ‘€ Contents" duration="0">
        <ul>
<li><a href="#aws-cdk-%E3%81%A8%E3%81%AF" target="_blank">AWS CDK ã¨ã¯</a></li>
<li><a href="#cdk-v2" target="_blank">CDK v2</a></li>
<li><a href="#%E5%AF%BE%E5%BF%9C%E8%A8%80%E8%AA%9E" target="_blank">å¯¾å¿œè¨€èª</a></li>
<li><a href="#cdk-%E3%83%AF%E3%83%BC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%83%E3%83%97" target="_blank">CDK ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—</a></li>
<li><a href="#cdk-%E3%81%AE%E6%A7%8B%E6%88%90%E8%A6%81%E7%B4%A0" target="_blank">CDK ã®æ§‹æˆè¦ç´ </a><ul>
<li><a href="#app" target="_blank">App</a></li>
<li><a href="#stacks" target="_blank">Stack(s)</a></li>
<li><a href="#construct" target="_blank">Construct</a><ul>
<li><a href="#l1-construct--l2-construct" target="_blank">L1 Construct / L2 Construct</a></li>
<li><a href="#patterns" target="_blank">Patterns</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#unit-test" target="_blank">Unit Test</a></li>
<li><a href="#cdk-%E3%81%AE%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89" target="_blank">CDK ã®ã‚³ãƒãƒ³ãƒ‰</a></li>
<li><a href="#cdk-%E4%BD%9C%E6%88%90%E6%99%82%E3%81%AE-metadata-%E3%82%92%E5%89%8A%E9%99%A4%E3%81%97%E3%81%9F%E3%81%84%E5%A0%B4%E5%90%88" target="_blank">CDK ä½œæˆæ™‚ã® Metadata ã‚’å‰Šé™¤ã—ãŸã„å ´åˆ</a></li>
<li><a href="#aws-cdk-%E3%81%A7%E3%81%AE%E9%96%8B%E7%99%BA%E6%96%B9%E6%B3%95" target="_blank">AWS CDK ã§ã®é–‹ç™ºæ–¹æ³•</a><ul>
<li><a href="#%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E6%A7%8B%E9%80%A0" target="_blank">ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ </a></li>
<li><a href="#%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E5%AE%9A%E7%BE%A9%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E5%9F%BA%E6%9C%AC%E6%A7%8B%E9%80%A0" target="_blank">ã‚¹ã‚¿ãƒƒã‚¯å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã®åŸºæœ¬æ§‹é€ </a></li>
<li><a href="#app-%E5%AE%9A%E7%BE%A9" target="_blank">App å®šç¾©</a></li>
<li><a href="#app-%E5%AE%9A%E7%BE%A9%E3%81%AB%E3%83%AA%E3%83%AA%E3%83%BC%E3%82%B9%E3%83%9F%E3%82%B9%E9%98%B2%E6%AD%A2%E7%AD%96" target="_blank">App å®šç¾©ã«ãƒªãƒªãƒ¼ã‚¹ãƒŸã‚¹é˜²æ­¢ç­–</a></li>
</ul>
</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="AWS CDK ã¨ã¯" duration="152">
        <p>AWS Cloud Development Kit ã®ã“ã¨ã§ã€ä½¿ã„æ…£ã‚ŒãŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã‚’ä½¿ç”¨ã—ã¦ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚</p>
<p>ã€AWS Black Belt Online Seminarã€‘<a href="https://youtu.be/1i7kWqpqtoY" target="_blank">AWS Cloud Development Kit (CDK)(YouTube)</a>(1:01:23)</p>
<p class="image-container"><img alt="blackbelt-cdk_3" src="img\\bb9079791b0424f.jpg"></p>
<p>ã€AWS Black Belt Online Seminarã€‘<a href="https://youtu.be/BmCpa44rAXI" target="_blank">AWS CDK æ¦‚è¦ (Basic #1)(YouTube)</a>(0:33:07)<a href="https://pages.awscloud.com/rs/112-TZM-766/images/AWS-Black-Belt_2023_AWS-CDK-Basic-1-Overview_0731_v1.pdf" target="_blank">PDF</a></p>
<p class="image-container"><img alt="blackbelt-cdk_1" src="img\\342c70ecd496531a.jpg"></p>
<p>ã€AWS Black Belt Online Seminarã€‘<a href="https://youtu.be/aqa2bFFzcjs" target="_blank">AWS CDK ã®åŸºæœ¬çš„ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨æ©Ÿèƒ½ (Basic #2)(YouTube)</a>(0:28:13)<a href="https://pages.awscloud.com/rs/112-TZM-766/images/AWS-Black-Belt_2023_AWS-CDK-Basic-2-Features_0831_v1.pdf" target="_blank">PDF</a></p>
<p class="image-container"><img alt="blackbelt-cdk_2" src="img\\c3170cfd7e8108f7.jpg"></p>
<p>ã€AWS Black Belt Online Seminarã€‘<a href="https://youtu.be/z3Mst77p-aU" target="_blank">AWS CDK ã®é–‹ç™ºã‚’åŠ¹ç‡åŒ–ã™ã‚‹æ©Ÿèƒ½ (Basic #3)(YouTube)</a>(0:29:20)<a href="https://pages.awscloud.com/rs/112-TZM-766/images/AWS-Black-Belt_2023_AWS-CDK-Basic-3-AppDev_0831_v1.pdf" target="_blank">PDF</a></p>
<p class="image-container"><img alt="blackbelt-cdk_3" src="img\\381bea663448dd31.jpg"></p>
<p><a href="https://aws.amazon.com/jp/cdk/" target="_blank">AWS ã‚¯ãƒ©ã‚¦ãƒ‰é–‹ç™ºã‚­ãƒƒãƒˆ</a></p>
<p><a href="https://docs.aws.amazon.com/cdk/api/v2/" target="_blank">AWS CDK Reference Documentation</a></p>
<p><a href="https://docs.aws.amazon.com/ja_jp/cdk/v2/guide/home.html" target="_blank">AWS CDK DEVELOPER GUIDE</a></p>
<p><a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-construct-library.html" target="_blank">AWS CDK API REFERENCE</a></p>
<p><a href="https://aws.amazon.com/jp/cdk/faqs/" target="_blank">AWS Cloud Development Kit ã®ã‚ˆãã‚ã‚‹è³ªå•</a></p>


      </google-codelab-step>
    
      <google-codelab-step label="CDK v2" duration="2">
        <p>CDK ã® v2 ã¯ã€2021 å¹´ 5 æœˆã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå®Ÿæ–½ã•ã‚Œã€ 2021 å¹´ 12 æœˆ 2 æ—¥ã« GA ã•ã‚Œã¾ã—ãŸã€‚</p>
<p>AWS Cloud Development Kit v2 é–‹ç™ºè€…ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ãŠçŸ¥ã‚‰ã› https://aws.amazon.com/jp/blogs/news/announcing-aws-cloud-development-kit-v2-developer-preview/</p>
<p>AWS Cloud Development Kit (AWS CDK) v2 ã®ä¸€èˆ¬æä¾›é–‹å§‹ https://aws.amazon.com/jp/about-aws/whats-new/2021/12/aws-cloud-development-kit-cdk-generally-available/</p>
<p>v2 ã§ã¯ Construct ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒ aws-cdk-lib ã«å˜ä¸€åŒ–ã•ã‚ŒãŸãŸã‚ã€v1 ã§å®Ÿæ–½ã—ã¦ã„ãŸå€‹ã€…ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒä¸è¦ã«ãªã‚Šã¾ã—ãŸã€‚</p>
<p>v1 ã§ã¯å€‹åˆ¥ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã£ãŸãŸã‚ã€å¾Œã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã—ãªã„ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒç•°ãªã£ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆã‚ã›ã‚‹ãŸã‚ã«ã€ã€Œnpm install @aws-cdk/aws-lambda@1.111.0ã€ã¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>
<pre><code language="language-ts" class="language-ts">npm install @aws-cdk/aws-lambda
npm install @aws-cdk/aws-cloudfront
npm install @aws-cdk/aws-iam
npm install @aws-cdk/aws-s3


import * as cdk from &#34;@aws-cdk/core&#34;;
import * as cloudfront from &#34;@aws-cdk/aws-cloudfront&#34;;
import * as s3 from &#34;@aws-cdk/aws-s3&#34;;
import * as iam from &#34;@aws-cdk/aws-iam&#34;;
</code></pre>
<p>v2 ã§ã¯å˜ä¸€ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«çµ±åˆã•ã‚ŒãŸãŸã‚ã€å€‹åˆ¥ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãªãä½¿ç”¨ã§ãã¾ã™ã€‚</p>
<pre><code language="language-ts" class="language-ts">npm install aws-cdk-lib

import {
  aws_s3 as s3,
  aws_iam as iam,
  aws_cloudfront as cloudfront,
from &#34;aws-cdk-lib&#34;;
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="å¯¾å¿œè¨€èª" duration="0">
        <ul>
<li>TypeScript</li>
<li>JavaScript</li>
<li>Python</li>
<li>Java</li>
<li>C#/.NET</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="CDK ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—" duration="0">
        <p>æ‰‹ã‚’å‹•ã‹ã—ã¦å­¦ã¶ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
<p>https://cdkworkshop.com/</p>


      </google-codelab-step>
    
      <google-codelab-step label="CDK ã®æ§‹æˆè¦ç´ " duration="0">
        <p class="image-container"><img alt="AppStacks.png" src="img\\e3686a243fe5e33.png"></p>
<p>å¼•ç”¨ï¼š<a href="https://docs.aws.amazon.com/ja_jp/cdk/v2/guide/home.html" target="_blank">é–‹ç™ºè€…ã‚¬ã‚¤ãƒ‰&gt;CDK ã¨ã¯</a></p>
<h2 is-upgraded>App</h2>
<p>CDK ã®æœ€ä¸Šä½å±¤ã§ã€è¤‡æ•°ã®ã‚¹ã‚¿ãƒƒã‚¯ã®ä¾å­˜é–¢ä¿‚ãªã©ã‚’å®šç¾©ã—ã¾ã™ã€‚</p>
<h2 is-upgraded>Stack(s)</h2>
<p>CloudFormation ã®ã‚¹ã‚¿ãƒƒã‚¯ã«å¯¾å¿œã—ã¾ã™ã€‚AWS ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¯ã“ã®ã‚¹ã‚¿ãƒƒã‚¯å˜ä½ã§è¡Œã„ã¾ã™ã€‚</p>
<h2 is-upgraded>Construct</h2>
<p>Stack å±¤ã« AWS ãƒªã‚½ãƒ¼ã‚¹ã®å®šç¾©ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
<p>Construct ã«ã¯ 3 ã¤ã®ç¨®é¡ãŒã‚ã‚Šã¾ã™ã€‚</p>
<ul>
<li>L1 Construct(Low Level Construct)</li>
<li>L2 Construct(High Level Construct)</li>
<li>L3 Construct(Patterns)</li>
</ul>
<h3 is-upgraded>L1 Construct / L2 Construct</h3>
<p>L1 Construct ã¨ã¯ã€Low Level Construct ã®ã“ã¨ã§ã™ã€‚CloudFormation ã®å„ãƒªã‚½ãƒ¼ã‚¹ã¨ 1:1 ã®é–¢ä¿‚ã«ãªã£ã¦ã„ã¾ã™ã€‚<code>Cfn</code>ã§å§‹ã¾ã‚‹ã‚‚ã®ãŒ L1 ã§ã™ã€‚</p>
<p>CloudFormation ã§å®šç¾©ã™ã‚‹ã®ã¨åŒã˜ãƒ¬ãƒ™ãƒ«ã§ã®è¨˜è¼‰ã«ãªã‚Šã¾ã™ã€‚L2 Construct ãŒå­˜åœ¨ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã¯ã€L2 Construct ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ãŒã€è¦ä»¶ã«å¿œã˜ãŸç´°ã‹ã„è¨­å®šãŒå¿…è¦ãªå ´åˆã¯ã€L1 Construct ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚</p>
<p>https://docs.aws.amazon.com/ja_jp/cdk/v2/guide/constructs.html#constructs_l1_using</p>
<pre><code language="language-ts" class="language-ts">const bucket = new s3.CfnBucket(this, &#34;MyBucket&#34;, {
  bucketName: &#34;MyBucket&#34;,
});
</code></pre>
<p>L2 Construct ã¨ã¯ã€High Level Construct ã¨å‘¼ã°ã‚Œã‚‹ã‚‚ã®ã§ã€L1 Construct ã‚’ãƒ©ãƒƒãƒ—ã—ãŸ Construct ã§ã™ã€‚</p>
<p>https://docs.aws.amazon.com/ja_jp/cdk/v2/guide/constructs.html#constructs_using</p>
<pre><code language="language-ts" class="language-ts">import * as s3 from &#34;aws-cdk-lib/aws-s3&#34;;

const bucket = new s3.Bucket(this, &#34;MyBucket&#34;, {
  versioned: true,
});
</code></pre>
<p>TypeScript ã‚’ä½¿ç”¨ã—ã¦ã€VPC ã‚’ä½œã‚‹å ´åˆã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ã™ã‚‹ã ã‘ã§ã€VPCã€ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã€NAT ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã€ã‚µãƒ–ãƒãƒƒãƒˆ 6 ã¤ï¼ˆ3 ç¨®é¡ Ã— maxAzs æ•°åˆ†ï¼‰ ã® CloudFormation å®šç¾©ã‚’ä½œæˆã—ã¦ãã‚Œã¾ã™ã€‚CloudFormation ã§è¨˜è¿°ã™ã‚‹ã¨ 430 è¡Œã«ã‚‚ãªã‚‹å®šç¾©ãŒ 12 è¡Œã ã‘ã§å®Œäº†ã—ã¾ã™ã€‚</p>
<p>cidrMask ã®æ•°å­—ã ã‘æŒ‡å®šã—ã¦ã„ã‚‹ã®ã§ã€ã‚µãƒ–ãƒãƒƒãƒˆã® CIDR ãƒ–ãƒ­ãƒƒã‚¯ã¯è‡ªå‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ã€‚CIDR ãƒ–ãƒ­ãƒƒã‚¯ã‚’ç‰¹å®šã®å€¤ã§æŒ‡å®šã—ãŸã„å ´åˆã¯ã€L1 Construct ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</p>
<pre><code language="language-ts" class="language-ts">const vpc = new ec2.Vpc(this, &#34;vpc&#34;, {
  vpcName: &#34;vpc&#34;,
  cidr: &#34;10.0.0.0/16&#34;,
  natGateways: 2,
  natGatewaySubnets: { subnetType: ec2.SubnetType.PUBLIC },
  maxAzs: 2,
  subnetConfiguration: [
    { subnetType: ec2.SubnetType.PUBLIC, name: &#34;public&#34;, cidrMask: 20 },
    {
      subnetType: ec2.SubnetType.PRIVATE_WITH_NAT,
      name: &#34;private&#34;,
      cidrMask: 19,
    },
    {
      subnetType: ec2.SubnetType.PRIVATE_ISOLATED,
      name: &#34;protected&#34;,
      cidrMask: 21,
    },
  ],
});
</code></pre>
<p>ã“ã®å®šç¾©ã‚’å®Ÿè¡Œã—ãŸå ´åˆã«ç”Ÿæˆã•ã‚Œã‚‹ CloudFormation ã®ã‚³ãƒ¼ãƒ‰ã¯æ¬¡ã®é€šã‚Šã§ã™ã€‚</p>
<p><img alt="vpc_cfn_00" src="img\\b6f6b7c87e4c41a8.png"> ï¼š ï¼š <img alt="vpc_cfn_01" src="img\\da9f8ff5f3dfb02c.png"></p>
<h3 is-upgraded>Patterns</h3>
<p>L3 Construct ã¨ã—ã¦ã€ECS Patterns ã®ã‚ˆã†ã« ECS é–¢é€£ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ç°¡å˜ã«ç”Ÿæˆã§ãã‚‹ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚</p>
<p>æ¬¡ã®ã‚ˆã†ã«ã™ã‚‹ã ã‘ã§ã€ECS ã‚µãƒ¼ãƒ“ã‚¹ã€ALBã€é–¢é€£ã™ã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã€ã‚¿ã‚¹ã‚¯ç”¨ã® IAM ãƒ­ãƒ¼ãƒ«ãªã© 200 ï½ 300 è¡Œã® CloudFormation ã®ã‚³ãƒ¼ãƒ‰ã‚’å‡ºåŠ›ã—ã¦ãã‚Œã¾ã™ã€‚</p>
<pre><code language="language-ts" class="language-ts">// ã‚¯ãƒ©ã‚¹ã‚¿ã‚’ä½œæˆ
const cluster = new ecs.Cluster(this, &#34;MyCluster&#34;, {
  vpc: props.vpc,
});

const loadBalancedFargateService =
  new ecs_patterns.ApplicationLoadBalancedFargateService(
    this,
    &#34;MyFargateService&#34;,
    {
      cluster: cluster,
      cpu: 4096,
      memoryLimitMiB: 30720,
      publicLoadBalancer: true,
      desiredCount: 6,
      taskImageOptions: {
        image: ecs.ContainerImage.fromRegistry(&#34;amazon/amazon-ecs-sample&#34;),
      },
    }
  );
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Unit Test" duration="0">
        <p>Jest ã‚’ä½¿ã£ãŸ Unit Test ã‚‚å®Ÿæ–½ã§ãã¾ã™ã€‚VPC ã®å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦ VPC ã‚„ã‚µãƒ–ãƒãƒƒãƒˆã®æ•°ã€ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã®çŠ¶æ…‹ãªã©ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
<p>ãŸã ã€&#34;AWS::EC2::VPC&#34; ã®ã‚ˆã†ã« AWS ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’çŸ¥ã£ã¦ã„ãªã„ã¨ã„ã‘ãªã„ã®ã§æ…£ã‚Œãªã„ã†ã¡ã¯æ‰‹é–“å–ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>
<pre><code language="language-ts" class="language-ts">test(&#34;create the vpc&#34;, () =&gt; {
  // GIVEN
  const app = new App({
    context: {
      PJName: &#34;junit&#34;,
      EnvName: &#34;prod&#34;,
      CidrBlock: &#34;10.0.0.0/16&#34;,
    },
  });
  const stack = new VPCStack(app, &#34;testing-vpcstack&#34;, {});
  // WHEN
  const template = Template.fromStack(stack);

  // THEN
  // VPC
  template.resourceCountIs(&#34;AWS::EC2::VPC&#34;, 1);
  template.hasResourceProperties(&#34;AWS::EC2::VPC&#34;, {
    CidrBlock: &#34;10.0.0.0/16&#34;,
  });

  // Subnet
  template.resourceCountIs(&#34;AWS::EC2::Subnet&#34;, 6);
  // Internet Gateway
  template.resourceCountIs(&#34;AWS::EC2::InternetGateway&#34;, 1);
  template.resourceCountIs(&#34;AWS::EC2::VPCGatewayAttachment&#34;, 1);
  template.hasResourceProperties(&#34;AWS::EC2::VPCGatewayAttachment&#34;, {
    VpcId: Match.anyValue(),
    InternetGatewayId: Match.anyValue(),
  });
  // Elastic IP
  template.resourceCountIs(&#34;AWS::EC2::EIP&#34;, 2);
  // NatGateway
  template.resourceCountIs(&#34;AWS::EC2::NatGateway&#34;, 2);
  template.hasResourceProperties(&#34;AWS::EC2::NatGateway&#34;, {
    AllocationId: Match.anyValue(),
    SubnetId: Match.anyValue(),
  });
  template.hasResourceProperties(&#34;AWS::EC2::NatGateway&#34;, {
    AllocationId: Match.anyValue(),
    SubnetId: Match.anyValue(),
  });
  // Route Table
  template.resourceCountIs(&#34;AWS::EC2::RouteTable&#34;, 6);
  template.resourceCountIs(&#34;AWS::EC2::Route&#34;, 4);
  template.hasResourceProperties(&#34;AWS::EC2::Route&#34;, {
    RouteTableId: Match.anyValue(),
    DestinationCidrBlock: &#34;0.0.0.0/0&#34;,
    GatewayId: Match.anyValue(),
  });
  template.hasResourceProperties(&#34;AWS::EC2::Route&#34;, {
    RouteTableId: Match.anyValue(),
    DestinationCidrBlock: &#34;0.0.0.0/0&#34;,
    NatGatewayId: Match.anyValue(),
  });
  template.resourceCountIs(&#34;AWS::EC2::SubnetRouteTableAssociation&#34;, 6);
  template.hasResourceProperties(&#34;AWS::EC2::SubnetRouteTableAssociation&#34;, {
    RouteTableId: Match.anyValue(),
    SubnetId: Match.anyValue(),
  });
});
</code></pre>
<p>ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ãŸçµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>
<p class="image-container"><img alt="jest" src="img\\6367ef8e8b0ae858.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="CDK ã®ã‚³ãƒãƒ³ãƒ‰" duration="0">
        <ul>
<li>cdk deploy https://docs.aws.amazon.com/ja_jp/cdk/v2/guide/cli.html#cli-deploy CDK ã§å®šç¾©ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã‚’ AWS ç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚ ã™ã¹ã¦ã®ã‚¹ã‚¿ãƒƒã‚¯ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã„å ´åˆã¯ã€<code>--all</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¾ã™ã€‚ æŒ‡å®šã—ãŸã‚¹ã‚¿ãƒƒã‚¯ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã„å ´åˆã¯ã€deploy ã®å¾Œã«ã‚¹ã‚¿ãƒƒã‚¯åã‚’æŒ‡å®šã—ã¾ã™ã€‚</li>
<li>cdk diff https://docs.aws.amazon.com/ja_jp/cdk/v2/guide/cli.html#cli-diff ç¾åœ¨ã® CDK ã¨ã™ã§ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã®å·®åˆ†ã‚’ç¢ºèªã—ã€å¤‰æ›´ç‚¹ã‚’ä¸€è¦§ã§å–å¾—ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚</li>
<li>cdk synth https://docs.aws.amazon.com/ja_jp/cdk/v2/guide/cli.html#cli-synth CDK ã§å®šç¾©ã•ã‚ŒãŸã‚¹ã‚¿ãƒƒã‚¯ã‚’ CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚ ãƒªã‚½ãƒ¼ã‚¹ã«ä»˜ä¸ã•ã‚Œã‚‹ Metadata ã‚’å‰Šé™¤ã—ãŸã„å ´åˆã¯ã€<code>--path-metadata false</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã—ã¾ã™ã€‚ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯å‡ºåŠ›ã›ãšã«ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å†…ã«è¨˜è¿°ã—ãŸ console.log() ã ã‘ç¢ºèªã—ãŸã„å ´åˆã¯ã€ <code>--quit</code> ã¾ãŸã¯ <code>-q</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã—ã¾ã™ã€‚</li>
<li>cdk ls https://docs.aws.amazon.com/ja_jp/cdk/v2/guide/cli.html#cli-list ç¾åœ¨ã® CDK ã‚¢ãƒ—ãƒªã«å«ã¾ã‚Œã‚‹ã‚¹ã‚¿ãƒƒã‚¯ã®ä¸€è¦§ã‚’ç¢ºèªã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="CDK ä½œæˆæ™‚ã® Metadata ã‚’å‰Šé™¤ã—ãŸã„å ´åˆ" duration="0">
        <p>CDK ã§ä½œæˆã•ã‚Œã‚‹ CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã¾ã™ã€‚</p>
<pre><code language="language-yaml" class="language-yaml">Resources:
  CDKMetadata:
    Type: AWS::CDK::Metadata
    Properties:
      Analytics: v2:deflate64:H4sIAAAAAAAAEzPUMzQw0TNQdEgsL9ZNTsnWT84vStWrDi5JTM7Wcc7PKy4pKk0u0XFOywtKLc4vLUpOBbGBEimZJZn5ebU6efkpqXpZxfplhmZ6hkCDsoozM3WLSvNKMnNT9YIgNAAtXENFZQAAAA==
    Metadata:
      aws:cdk:path: DevioStack/CDKMetadata/Default
    Condition: CDKMetadataAvailable
Conditions:
  CDKMetadataAvailable:
    Fn::Or:
      - Fn::Or:
          - Fn::Equals:
              - Ref: AWS::Region
              - af-south-1
:
</code></pre>
<p>ã“ã‚Œã¯ã€æ¬¡ã®ã‚ˆã†ãªç›®çš„ã§ä»˜ä¸ã•ã‚Œã‚‹å†…å®¹ã§ã™ã€‚</p>
<p class="image-container"><img alt="cdk-metadata.png" src="img\\c196590b479360d9.png"></p>
<p>ã“ã‚Œã‚’ä»˜ä¸ã—ãŸããªã„å ´åˆã¯ã€cdk ã‚³ãƒãƒ³ãƒ‰ã«ä»¥ä¸‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¦å®Ÿè¡Œã—ã¾ã™ã€‚</p>
<pre><code language="language-sh" class="language-sh">cdk synth --no-version-reporting --path-metadata false
</code></pre>
<p>cdk.json ã« <code>"versionReporting": false,</code> ã‚’è¿½åŠ ã—ã¾ã™ã€‚</p>
<p class="image-container"><img alt="versionReporting" src="img\\d33ef30652cc0c8b.png"></p>
<p>GitHub ãªã©ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ããŸ CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã“ã®ã‚ˆã†ãª Metadata ã®è¨˜è¼‰ãŒã‚ã‚‹å ´åˆã¯ã€æ¶ˆã—ã¦ã‚‚å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚</p>


      </google-codelab-step>
    
      <google-codelab-step label="AWS CDK ã§ã®é–‹ç™ºæ–¹æ³•" duration="0">
        <h2 is-upgraded>ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ </h2>
<p><code>cdk init --typescript</code> ã‚’å®Ÿè¡Œã™ã‚‹ã¨åˆæœŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒä½œæˆã•ã‚Œã¾ã™ã€‚ é€šå¸¸ã¯ã€[lib] ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚¹ã‚¿ãƒƒã‚¯ã®æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ã¾ã™ã€‚ã—ã‹ã—ã€å…±é€šã§åˆ©ç”¨ã—ãŸã„ã‚‚ã®ãªã©ãŒå‡ºã¦ããŸã¨ãã«åˆ†ã‹ã‚Šã«ãããªã‚‹ã®ã§ã€[stacks] ã¨ [utils] ãªã©ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚å¿…è¦ã«ãªã£ãŸã‚‰ [lib] å†…ã«ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚ â€˜*&#39; ãŒä»˜ã„ã¦ã„ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒè¿½åŠ ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã™ã€‚</p>
<pre><code language="language-text" class="language-text">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
    â”œâ”€ [bin]                   // Appå®šç¾©ã€‚è¤‡æ•°ã®ã‚¹ã‚¿ãƒƒã‚¯ã®ä¾å­˜é–¢ä¿‚ãªã©ã‚’å®šç¾©
    â”œâ”€ [lib]
        â”œâ”€ *[stacks]           // ã‚¹ã‚¿ãƒƒã‚¯å®šç¾©
        â”œâ”€ *[resources]        // å„ãƒªã‚½ãƒ¼ã‚¹ã”ã¨ã®å®šç¾©ã€‚ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰å‘¼ã°ã‚Œã‚‹
        â”œâ”€ *[utils]            // å…±é€šä½¿ç”¨ã™ã‚‹ã‚‚ã®ã‚’æ ¼ç´
    â”œâ”€ *[parameters]           // ç’°å¢ƒä¾å­˜æƒ…å ±ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ ¼ç´ï¼ˆâ€»contextã‚’ä½¿ã‚ãªã„ï¼‰
    â”œâ”€ *[src]                  // Lambda ã‚„ HTML ãªã©ã®ã‚½ãƒ¼ã‚¹ã‚’æ ¼ç´
    â”œâ”€ [test]                  // ãƒ†ã‚¹ãƒˆ
    â”œâ”€ [node_modules]
    â”œâ”€ cdk.context.json        // ç’°å¢ƒä¾å­˜æƒ…å ±(context)
    â”œâ”€ cdk.json                // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®appãªã©ãŒå…¥ã‚‹
    â”œâ”€ cdk.out                 // cfnãªã©ã®å‡ºåŠ›å…ˆã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸjsã‚’å‹•ã‹ã™ã¨å‡ºåŠ›ã•ã‚Œã‚‹
    â”œâ”€ jest.config.js          // ãƒ†ã‚¹ãƒˆã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
    â”œâ”€ package-lock.json
    â”œâ”€ package.json
    â”œâ”€ tsconfig.json
    â”œâ”€ README.md
</code></pre>
<h2 is-upgraded>ã‚¹ã‚¿ãƒƒã‚¯å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã®åŸºæœ¬æ§‹é€ </h2>
<p><code>lib/stacks</code> ã«é…ç½®ã™ã‚‹ã‚¹ã‚¿ãƒƒã‚¯å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚</p>
<pre><code language="language-ts" class="language-ts">import { Stack, StackProps , CfnMapping} from &#39;aws-cdk-lib&#39;;
import { Construct } from &#39;constructs&#39;;
import * as cdk from &#39;aws-cdk-lib&#39;;
import { // ã“ã“ã«ãƒªã‚½ãƒ¼ã‚¹ä½œæˆã«å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’åˆ—æŒ™ã—ã¾ã™
  aws_ec2 as ec2,
  aws_s3 as s3,
    :
} from &#39;aws-cdk-lib&#39;;

interface IMyStackProps extends StackProps {
  // ã‚¹ã‚¿ãƒƒã‚¯å®Ÿè¡Œæ™‚ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®š
  readonly PJName: string;
  readonly EnvName: string;
   :
}

export class MyStack extends Stack {
  // åˆ¥ã®ã‚¹ã‚¿ãƒƒã‚¯ã§å‚ç…§
  public readonly xxx: string;

  constructor(scope: Construct, id: string, props: IMyStackProps) {
    super(scope, id, props);


    // ã‚¿ã‚°ã‚’ä»˜ä¸ã™ã‚‹ -&gt; ã“ã“ã‚’æŒ‡å®šã—ã¦ãŠãã¨å…¨ã¦ã«ã‚¿ã‚°ä»˜ã‘ã—ã¦ãã‚Œã¾ã™ã€‚
    cdk.Tags.of(this).add(&#39;Project&#39;, props.PJName);
    cdk.Tags.of(this).add(&#39;Environment&#39;, props.EnvName);

  }
}

</code></pre>
<h2 is-upgraded>App å®šç¾©</h2>
<p><code>bin</code> ã«é…ç½®ã™ã‚‹ã‚¹ã‚¿ãƒƒã‚¯ã®ä¾å­˜é–¢ä¿‚ã‚’å®šç¾©ã—ã¦ãŠããƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚</p>
<pre><code language="language-ts" class="language-ts">#!/usr/bin/env node
import &#39;source-map-support/register&#39;;
import * as cdk from &#39;aws-cdk-lib&#39;;
import { MyStack } from &#39;../lib/stacks/cdk-my-stack&#39;;

const app = new cdk.App();

// ç’°å¢ƒè­˜åˆ¥å­ã®æŒ‡å®š -&gt; ç’°å¢ƒè­˜åˆ¥å­ã¯ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã« &#39;-c env=xxx&#39; ã¨æŒ‡å®šã™ã‚‹
const envname: string = app.node.tryGetContext(&#39;env&#39;)
// ç’°å¢ƒè­˜åˆ¥å­ã®ãƒã‚§ãƒƒã‚¯
if (!envname.match(/^(dev|test|stage|prod)$/)) {
  console.warn(&#39;Invalid context. envname must be [dev , test, stage, prod].&#39;)
  process.exit(1)
}

// ã‚¹ã‚¿ãƒƒã‚¯
const myStack = new MyStack (app, &#39;MyStack &#39;, {
  stackName: &#34;ã“ã“ã«ã‚¹ã‚¿ãƒƒã‚¯åã‚’è¨˜è¿°&#34;, // ç’°å¢ƒè­˜åˆ¥å­ã‚’ã¤ã‘ãŸã„å ´åˆã¯ã€`xxxx-${envname}` ã®ã‚ˆã†ã«ã§ãã‚‹ã€‚
  description: &#34;ã“ã“ã«ã‚¹ã‚¿ãƒƒã‚¯ã®èª¬æ˜ã‚’è¨˜è¿°&#34;,
  // ã“ã“ã‹ã‚‰ã‚¹ã‚¿ãƒƒã‚¯ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
  PJName: conf.PJName,
  EnvName: conf.EnvName,
  :
  // ã“ã“ã¾ã§ã‚¹ã‚¿ãƒƒã‚¯ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

  // ä»¥ä¸‹ã¯åŸºæœ¬çš„ã«ã©ã®ã‚¹ã‚¿ãƒƒã‚¯ã§ã‚‚å›ºå®šã§æŒ‡å®šã™ã‚‹
  env: {
    account: process.env.CDK_DEFAULT_ACCOUNT,
    region: &#34;us-east-1&#34; // ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®šã—ãŸã„å ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚ˆã„å ´åˆã¯process.env.CDK_DEFAULT_REGION ã¨ã™ã‚‹
  },
  terminationProtection: true, // å‰Šé™¤ä¿è­·ã®æœ‰åŠ¹åŒ– -&gt; ã‚¹ã‚¿ãƒƒã‚¯ä½œæˆã¨åŒæ™‚ã«å‰Šé™¤ä¿è­·ã‚’æœ‰åŠ¹ã«ã§ãã¾ã™ã€‚ãŸã ã—ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰è§£é™¤ã—ãªã„ã¨ cdk destroy ã§ããªã„

});
</code></pre>
<h2 is-upgraded>App å®šç¾©ã«ãƒªãƒªãƒ¼ã‚¹ãƒŸã‚¹é˜²æ­¢ç­–</h2>
<p>ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã¨ãã¯ã€<code>cdk deploy MyStack -c env=dev --profile xxxxx</code> ã¨ã—ã¦ã€AWS ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®šã™ã‚‹ã®ãŒä¸€èˆ¬çš„ã§ã™ãŒã€ã“ã‚Œã ã¨ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«åã‚’é–“é•ãˆã¦ã—ã¾ã£ãŸå ´åˆã€é–“é•ã£ãŸç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã—ã¾ã†å±é™ºãŒã‚ã‚Šã¾ã™ã€‚</p>
<p>ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã§æ³¨æ„å–šèµ·ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚ã‚‹ã¨ã€ãã‚Œã ã‘ã§æ°—ä»˜ãã“ã¨ãŒã‚ã‚ŠãƒŸã‚¹é˜²æ­¢ã«ã‚‚ãªã‚Šã¾ã™ã€‚</p>
<p>ãã®æ–¹æ³•ã¯ã€env ã§ä¸ãˆã‚‰ã‚Œã‚‹ç’°å¢ƒã«ã‚ˆã£ã¦ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã™ã‚‹æ–¹æ³•ã§ã™ã€‚</p>
<p><code>prod</code> ã¨ã—ãŸç’°å¢ƒã®å ´åˆã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
<p class="image-container"><img alt="CAUTION" src="img\\2af251baa121141b.png"></p>
<pre><code language="language-text" class="language-text">// æ–‡å­—è‰²
const color_red: string = &#34;\u001b[31m&#34;;
const color_green: string = &#34;\u001b[32m&#34;;
const color_yellow: string = &#34;\u001b[33m&#34;;
const color_white: string = &#34;\u001b[37m&#34;;
const color_reset: string = &#34;\u001b[0m&#34;;

console.log();
console.log(`${color_yellow}##########################################${color_reset}`);
console.log(`${color_yellow}  sample ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ${color_reset}`);
console.log(`${color_yellow}  ãƒªãƒªãƒ¼ã‚¹ç’°å¢ƒï¼š${color_reset} ${color_red}${envname}${color_reset}`);
console.log(`${color_yellow}##########################################${color_reset}`);
console.log();

// ç’°å¢ƒè­˜åˆ¥å­ã®ãƒã‚§ãƒƒã‚¯
if (!envname.match(/^(dev|test|stage|prod|jump)$/)) {
  console.warn(&#39;Invalid context. envname must be [dev , test, stage, prod, jump].&#39;);
  process.exit(1);
}

const isProduction:boolean = envname.match(/^(prod)$/) ? true: false;
if (isProduction) {
  console.log(`${color_red}!!!!!!!!!! CAUTION !!!!!!!!!!${color_reset}`);
  console.log(`${color_red}   æœ¬ç•ªç’°å¢ƒã¸ã®ãƒªãƒªãƒ¼ã‚¹ã§ã™ã€‚${color_reset}`);
  console.log(`${color_red}!!!!!!!!!! CAUTION !!!!!!!!!!${color_reset}`);
};
</code></pre>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/claat-public/native-shim.js"></script>
  <script src="https://storage.googleapis.com/claat-public/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/claat-public/prettify.js"></script>
  <script src="https://storage.googleapis.com/claat-public/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
