# AWS Systems Manager（SSM）:ノード管理<!-- omit in toc -->

## はじめに<!-- omit in toc -->

本ページは、AWS に関する個人の勉強および勉強会で使用することを目的に、AWS ドキュメントなどを参照し作成しておりますが、記載の誤り等が含まれる場合がございます。

最新の情報については、AWS 公式ドキュメントをご参照ください。

## Contents<!-- omit in toc -->

<!-- Duration: 00:01:00 -->

- [ノード管理の機能](#ノード管理の機能)
- [パラメータストア](#パラメータストア)
- [メンテナンスウィンドウ](#メンテナンスウィンドウ)
- [ドキュメント](#ドキュメント)
- [コンカレンシー](#コンカレンシー)
- [セキュリティ](#セキュリティ)
- [変更カレンダー](#変更カレンダー)
- [オートメーション](#オートメーション)

## ノード管理の機能

- ノード管理
  - フリートマネージャー
  - コンプライアンス
  - インベントリ
  - ハイブリッドアクティベーション
  - セッションマネージャー
  - Run Command
  - ステートマネージャー
  - パッチマネージャー
  - ディストリビューター

よく使う機能から順番に解説します。

https://dev.classmethod.jp/articles/aws-systems-manager-all-you-need-to-know-japanese/

## パラメータストア

設定値やシークレットなどを安全に保存できる機能です。

![ps-1](/images/ssm/parameter-store/parameterstore-1.png)

パラメータストアには最大スループットという制限があります。

デフォルトのスループットは、毎秒 40 です。
高スループットの場合は、毎秒 10,000 です。高スループットにすると、追加料金が発生します。
詳しくは [Parameter Store 料金](https://aws.amazon.com/jp/systems-manager/pricing/)を確認してください。

高スループットにするには、設定より変更することができます。また、高スループットが不要になった場合は元に戻す（制限をリセットする）ことが可能です。

![ps-2](/images/ssm/parameter-store/parameterstore-2.png)

![ps-3](/images/ssm/parameter-store/parameterstore-3.png)

## メンテナンスウィンドウ

パッチ適用やソフトウェアのインストール、OS のアップグレードなどの一連のタスクをスケジュール実行できる機能です。

## ドキュメント

SSM には、Run Commands、Automation、States Manager で使用することができる多くの既成のドキュメントが付属しています。また、独自にドキュメントを作成することも可能です。SSM のドキュメント権限は AWS IAM と連携しており、AWS IAM のポリシーを使って誰がどのドキュメントの実行権限を持つか管理できるようになっている。

## コンカレンシー

コマンドや自動化ドキュメントを並列に実行するために、SSM では対象インスタンスの割合や数を指定することができます。また、エラーを投げるターゲット・インスタンスの数がある閾値に達した場合、オペレーションを停止することもあります。

## セキュリティ

セキュリティはあらゆるシステムの重要な要素であり、SSM エージェントはサーバーのルートとして実行されるため、そのセキュリティをよりよく理解するのに役立ちます。

SSM エージェントは、SSM サービスから保留中の注文を取得し、プル機構を介してインスタンス上で実行する。
SSM エージェントとサービス間の通信は、HTTPS プロトコルを採用した安全なチャネルを介して行われます。
SSM エージェントのコードはオープンソースなので、その内容を正確に見ることができます。
すべての API コールをログに記録するために、SSM サービスは AWS CloudTrail と連携することができます。

## 変更カレンダー

重要なイベントや負荷が集中する時間帯、バッチ処理が行われる時間帯などを設定することで、定期実行処理を回避することができます。

## オートメーション

インスタンス上でリモートコマンドを実行できるようにしたものです。自動化ではリモート命令以外にも、例えば実行の一部として AWS の API を利用することができます。SSM 自動化タイプのドキュメントを利用することで、多くの段階を組み合わせて複雑なタスクを完了させることもあります。なお、SSM サービス上で動作する自動ドキュメントの最大実行時間 AWS アカウントと AWS リージョンあたり、1,000,000 秒となります。