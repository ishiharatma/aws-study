# AWS ã‚³ã‚¹ãƒˆç®¡ç†

## â˜˜ï¸ ã¯ã˜ã‚ã«

æœ¬ãƒšãƒ¼ã‚¸ã¯ã€AWS ã«é–¢ã™ã‚‹å€‹äººã®å‹‰å¼·ãŠã‚ˆã³å‹‰å¼·ä¼šã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã«ã€AWS ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãªã©ã‚’å‚ç…§ã—ä½œæˆã—ã¦ãŠã‚Šã¾ã™ãŒã€è¨˜è¼‰ã®èª¤ã‚Šç­‰ãŒå«ã¾ã‚Œã‚‹å ´åˆãŒã”ã–ã„ã¾ã™ã€‚

æœ€æ–°ã®æƒ…å ±ã«ã¤ã„ã¦ã¯ã€AWS å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã”å‚ç…§ãã ã•ã„ã€‚

## ğŸ‘€ Contents

- [AWS ã‚³ã‚¹ãƒˆç®¡ç†](#aws-ã‚³ã‚¹ãƒˆç®¡ç†)
  - [â˜˜ï¸ ã¯ã˜ã‚ã«](#ï¸-ã¯ã˜ã‚ã«)
  - [ğŸ‘€ Contents](#-contents)
  - [AWS ã‚³ã‚¹ãƒˆç®¡ç† ã¨ã¯](#aws-ã‚³ã‚¹ãƒˆç®¡ç†-ã¨ã¯)
  - [ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã®ç‰¹æ€§ã‚’æŠŠæ¡ã™ã‚‹](#ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã®ç‰¹æ€§ã‚’æŠŠæ¡ã™ã‚‹)
  - [æ–™é‡‘ä½“ç³»ã‚’ç†è§£ã™ã‚‹](#æ–™é‡‘ä½“ç³»ã‚’ç†è§£ã™ã‚‹)
  - [æƒ³å®šå¤–ã®ã‚³ã‚¹ãƒˆãŒç™ºç”Ÿã™ã‚‹è¦å› ã‚’ç†è§£ã™ã‚‹](#æƒ³å®šå¤–ã®ã‚³ã‚¹ãƒˆãŒç™ºç”Ÿã™ã‚‹è¦å› ã‚’ç†è§£ã™ã‚‹)
  - [ã‚³ã‚¹ãƒˆã®å¯è¦–åŒ–](#ã‚³ã‚¹ãƒˆã®å¯è¦–åŒ–)
    - [AWS Cost Explorer ã§å¯è¦–åŒ–ã™ã‚‹](#aws-cost-explorer-ã§å¯è¦–åŒ–ã™ã‚‹)
    - [AWS Cost and Usage Report ã§å¯è¦–åŒ–ã™ã‚‹](#aws-cost-and-usage-report-ã§å¯è¦–åŒ–ã™ã‚‹)
    - [ã‚³ã‚¹ãƒˆç•°å¸¸ã‚’æ¤œå‡ºã™ã‚‹](#ã‚³ã‚¹ãƒˆç•°å¸¸ã‚’æ¤œå‡ºã™ã‚‹)
    - [äºˆç®—ã‚’ä½œæˆã—ã¦æŠŠæ¡ã™ã‚‹](#äºˆç®—ã‚’ä½œæˆã—ã¦æŠŠæ¡ã™ã‚‹)
    - [Amazon Athena ã‚’åˆ©ç”¨ã—ã¦å¯è¦–åŒ–ã™ã‚‹](#amazon-athena-ã‚’åˆ©ç”¨ã—ã¦å¯è¦–åŒ–ã™ã‚‹)
    - [AWS Cost Categories](#aws-cost-categories)
    - [ã‚³ã‚¹ãƒˆåˆ†é…ã‚¿ã‚°](#ã‚³ã‚¹ãƒˆåˆ†é…ã‚¿ã‚°)
  - [ã‚³ã‚¹ãƒˆå‰Šæ¸›ãƒã‚¤ãƒ³ãƒˆ](#ã‚³ã‚¹ãƒˆå‰Šæ¸›ãƒã‚¤ãƒ³ãƒˆ)

## AWS ã‚³ã‚¹ãƒˆç®¡ç† ã¨ã¯

AWS ã‚’åˆ©ç”¨ã™ã‚‹ä¸Šã§ã€ã‚³ã‚¹ãƒˆã®ç®¡ç†ã¯é¿ã‘ã‚‰ã‚Œã¾ã›ã‚“ã€‚åˆ©ç”¨ã—ã¦ã„ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã®èª²é‡‘ä½“ç³»ã¨åˆ©ç”¨çŠ¶æ³ã‚’æŠŠæ¡ã—ã¦é‹ç”¨ã‚’è¡Œã‚ãªã„ã¨ã€ã€Œçªç„¶é«˜é¡è«‹æ±‚ãŒï¼ã€ã¨ã„ã£ãŸçŠ¶æ³ãŒç™ºç”Ÿã—ã€å®Ÿéš›ã«ãã®ã‚ˆã†ãªäº‹ä¾‹ã‚‚å¤šãã‚ã‚Šã¾ã™ã€‚

ã€AWS Black Belt Online Seminarã€‘[xx(YouTube)](xxx)(1:00:33)

![xx](/images/xx/)

[xx ã‚µãƒ¼ãƒ“ã‚¹æ¦‚è¦](https://aws.amazon.com/jp/xx/)

[xx ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.aws.amazon.com/ja_jp/xx/?id=docs_gateway)

[xx ã‚ˆãã‚ã‚‹è³ªå•](https://aws.amazon.com/jp/xx/faqs/)

## ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã®ç‰¹æ€§ã‚’æŠŠæ¡ã™ã‚‹

ãƒ“ã‚¸ãƒã‚¹ã®ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã¨ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ãªç‰¹æ€§ã‚’æŠŠæ¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

- ãƒ‡ãƒ¼ã‚¿é‡
- HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°
- ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆæ™‚é–“å¸¯ã«ã‚ˆã‚‹ã‚¢ã‚¯ã‚»ã‚¹ã€æ€¥æ¿€ãªã‚¢ã‚¯ã‚»ã‚¹ï¼‰

## æ–™é‡‘ä½“ç³»ã‚’ç†è§£ã™ã‚‹

AWS ã®åˆ©ç”¨æ–™é‡‘ã¯å¾“é‡èª²é‡‘åˆ¶ã§ã™ãŒã€ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚ˆã£ã¦èª²é‡‘ã•ã‚Œã‚‹å˜ä½ãŒç•°ãªã‚Šã¾ã™ã€‚

èª²é‡‘å˜ä½ã‚’å¤§ããåˆ†ã‘ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚

- åˆ©ç”¨æ™‚é–“
  - ãƒªã‚½ãƒ¼ã‚¹ãŒä½œæˆã•ã‚Œã‚‹ã¨ã€ãã®åˆ©ç”¨æ™‚é–“ï¼ˆèµ·å‹•æ™‚é–“ï¼‰ã§æ–™é‡‘ãŒç™ºç”Ÿã—ã¾ã™
  - åˆ©ç”¨é‡ã«æ¯”ã¹ã‚‹ã¨ã‚³ã‚¹ãƒˆè¦‹ç©ãŒå®¹æ˜“ã§ã€ã‚³ã‚¹ãƒˆå‰Šæ¸›ã‚‚ã‚„ã‚Šã‚„ã™ã„
- åˆ©ç”¨é‡ï¼ˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚„ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ã‚µã‚¤ã‚ºãªã©ï¼‰
  - ãƒªã‚½ãƒ¼ã‚¹ã®ä½œæˆè‡ªä½“ã«ã¯æ–™é‡‘ãŒã‹ã‹ã‚‰ãšã€ã‚¤ãƒ™ãƒ³ãƒˆæ•°ã‚„ä½¿ç”¨å®¹é‡ã«å¿œã˜ã¦æ–™é‡‘ãŒç™ºç”Ÿã—ã¾ã™
  - ãƒ“ã‚¸ãƒã‚¹ã®ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã«å½±éŸ¿ã•ã‚Œã‚‹ãŸã‚ã€ã‚³ã‚¹ãƒˆã®è¦‹ç©ã‚„ã‚³ã‚¹ãƒˆå‰Šæ¸›ãŒé›£ã—ã„
- æœˆé¡å›ºå®šï¼ˆRoute 53 ã®ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ãªã©ï¼‰
  - ãƒªã‚½ãƒ¼ã‚¹ãŒä½œæˆã•ã‚Œã‚‹ã¨ã€æœˆé¡å›ºå®šã§æ–™é‡‘ãŒç™ºç”Ÿã—ã¾ã™

ã¾ãŸã€ã‚µãƒãƒ¼ãƒˆå¥‘ç´„ã®æ–™é‡‘ã‚‚ç†è§£ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

[AWS Support ãƒ—ãƒ©ãƒ³æ¯”è¼ƒ](https://aws.amazon.com/jp/premiumsupport/plans/)

## æƒ³å®šå¤–ã®ã‚³ã‚¹ãƒˆãŒç™ºç”Ÿã™ã‚‹è¦å› ã‚’ç†è§£ã™ã‚‹

æ–™é‡‘ä½“ç³»ã‚’ç†è§£ã—ã¦ã„ã¦ã‚‚ã€é‹ç”¨ä¸­ã«ã¯ã†ã£ã‹ã‚Šæƒ³å®šå¤–ã®ã‚³ã‚¹ãƒˆãŒç™ºç”Ÿã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

æƒ³å®šå¤–ã®ã‚³ã‚¹ãƒˆãŒç™ºç”Ÿã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯æ¬¡ã®ã‚ˆã†ãªã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚

- ãƒªã‚½ãƒ¼ã‚¹ã®æ¶ˆã—å¿˜ã‚Œã‚„æˆ»ã—å¿˜ã‚Œ
- ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã®è‚¥å¤§åŒ–
- ç®¡ç†ç³»ã‚µãƒ¼ãƒ“ã‚¹ã®è‚¥å¤§åŒ–
- ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã®è¿½åŠ ã‚³ã‚¹ãƒˆ
- ã‚µãƒ¼ãƒ“ã‚¹ä»•æ§˜ã®è€ƒæ…®ä¸è¶³
- æ–™é‡‘å˜ä½ã®ç†è§£ä¸è¶³

## ã‚³ã‚¹ãƒˆã®å¯è¦–åŒ–

Duration: 0:01:30

### AWS Cost Explorer ã§å¯è¦–åŒ–ã™ã‚‹

[AWS Cost Explorer](https://aws.amazon.com/jp/aws-cost-management/aws-cost-explorer/)

AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆå¾Œã¯ã€IAM ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ Cost Explorer ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã€‚ã“ã®ã¾ã¾ã§ã¯ãƒ«ãƒ¼ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã—ã‹ç¢ºèªã§ãã¾ã›ã‚“ã€‚IAM ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åˆ©ç”¨ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆå¾Œã™ãã«ã€ŒIAM ãƒ¦ãƒ¼ã‚¶ãƒ¼/ãƒ­ãƒ¼ãƒ«ã«ã‚ˆã‚‹è«‹æ±‚æƒ…å ±ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã€ã‚’æœ‰åŠ¹åŒ–ã—ã¾ã—ã‚‡ã†ã€‚

[ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§è«‹æ±‚ãƒ‡ãƒ¼ã‚¿ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’æœ‰åŠ¹ã«ã™ã‚‹](https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/tutorial_billing.html#tutorial-billing-step1)

æ¬¡ã«ã€è«‹æ±‚ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ã€Cost Explorer ã‚’é–‹ãã€ã€ŒCost Explorer ã‚’èµ·å‹•ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
åˆã‚ã¦é–‹ã„ãŸã¨ãã‹ã‚‰æœ‰åŠ¹ã«ãªã‚Šã€å½“æœˆã®ãƒ‡ãƒ¼ã‚¿ã¯ç´„ 24 æ™‚é–“å¾Œã«è¡¨ç¤ºå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

![cost_explorer](/images/costmanagement/cost_explorer.png)

[Cost Explorer ã‚’æœ‰åŠ¹ã«ã™ã‚‹](https://docs.aws.amazon.com/ja_jp/cost-management/latest/userguide/ce-enable.html)

åŸºæœ¬çš„ãªä½¿ã„æ–¹ã¯ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚è€ƒã«ã—ã¾ã™ã€‚

[Cost Explorer ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æ¢ç´¢ã™ã‚‹](https://docs.aws.amazon.com/ja_jp/cost-management/latest/userguide/ce-exploring-data.html)

Cost Explorer ã®ç”»é¢ã§æŒ‡å®šã—ãŸãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¡ä»¶ã¯ URL ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«åæ˜ ã•ã‚Œã¦ã„ã¾ã™ã€‚
ãã®ã¾ã¾ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã«ç™»éŒ²ã™ã‚‹ã“ã¨ã§ã€æ¬¡å›ã‚‚åŒã˜æ¡ä»¶ã§è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

[Cost Explorer ã®è¨­å®šã‚’ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã¾ãŸã¯ãŠæ°—ã«å…¥ã‚Šã¨ã—ã¦ä¿å­˜ã™ã‚‹](https://docs.aws.amazon.com/ja_jp/cost-management/latest/userguide/ce-bookmarks.html)

### AWS Cost and Usage Report ã§å¯è¦–åŒ–ã™ã‚‹

[AWS Cost and Usage Reports](https://aws.amazon.com/jp/aws-cost-management/aws-cost-and-usage-reporting/)

Cost and Usage Report ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯æœ‰åŠ¹ã«ãªã£ã¦ãŠã‚‰ãšã€ã€Œãƒ¬ãƒãƒ¼ãƒˆã®ä½œæˆã€ã‚’è¡Œã†ã“ã¨ã§æœ‰åŠ¹ã«ãªã‚Šã¾ã™ã€‚

![cost_usage_report](/images/costmanagement/cost_usage_report.png)

è©³ã—ã„ãƒ¬ãƒãƒ¼ãƒˆä½œæˆæ–¹æ³•ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚è€ƒã«ã—ã¾ã™ã€‚

![ã‚³ã‚¹ãƒˆã¨ä½¿ç”¨çŠ¶æ³ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã™ã‚‹](https://docs.aws.amazon.com/ja_jp/cur/latest/userguide/creating-cur.html)

### ã‚³ã‚¹ãƒˆç•°å¸¸ã‚’æ¤œå‡ºã™ã‚‹

[AWS ã‚³ã‚¹ãƒˆç•°å¸¸æ¤œå‡º](https://aws.amazon.com/jp/aws-cost-management/aws-cost-anomaly-detection/)

[AWS ç•°å¸¸æ¤œå‡ºã§ç•°å¸¸ãªä½¿ç”¨æ–™ã‚’æ¤œå‡ºã™ã‚‹](https://docs.aws.amazon.com/ja_jp/cost-management/latest/userguide/manage-ad.html)

æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€é€šå¸¸ã¨ã¯ç•°ãªã‚‹ã‚³ã‚¹ãƒˆã®ç™ºç”Ÿã‚’æ¤œçŸ¥ã§ãã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚ã“ã‚Œã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§æƒ³å®šå¤–ã®ã‚³ã‚¹ãƒˆãŒç™ºç”Ÿã™ã‚‹ã“ã¨ã‚’æŠŠæ¡ã§ãã€äºˆã‚å¯¾å¿œã‚’è¡Œã†ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

![cost-anomaly-detection](/images/costmanagement/cost-anomaly-detection.png)

æ¤œçŸ¥ã«æ•·å±…å€¤ã‚’è¨­å®šã™ã‚‹ã“ã¨ã¯ã§ãã¾ã™ãŒã€åŸºæœ¬çš„ã«ã¯éå»ã®åˆ©ç”¨å‚¾å‘ã‹ã‚‰è‡ªå‹•çš„ã«ãƒã‚§ãƒƒã‚¯ã—æ¤œçŸ¥ã™ã‚‹ãŸã‚ã€é›£ã—ã„å®šç¾©ãªã©è¡Œã‚ãªãã¦ã‚‚åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ã‚³ã‚¹ãƒˆç•°å¸¸æ¤œçŸ¥è‡ªä½“ã¯ç„¡æ–™ã§åˆ©ç”¨ã§ãã¾ã™ã®ã§ã€è¨­å®šã—ã¦ãŠãã®ãŒã‚ˆã„ã§ã—ã‚‡ã†ã€‚
ãŸã ã—ã€é€šçŸ¥å…ˆã« Amazon SNS ãªã©ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã¯ãã®åˆ©ç”¨é‡ã«å¿œã˜ãŸæ–™é‡‘ã¯ç™ºç”Ÿã—ã¾ã™ã€‚

### äºˆç®—ã‚’ä½œæˆã—ã¦æŠŠæ¡ã™ã‚‹

[AWS Budgets](https://aws.amazon.com/jp/aws-cost-management/aws-budgets/)

[AWS Budgets ã‚’ç”¨ã„ã¦ã‚³ã‚¹ãƒˆã‚’ç®¡ç†ã™ã‚‹](https://docs.aws.amazon.com/ja_jp/cost-management/latest/userguide/budgets-managing-costs.html)

äºˆã‚è¨­å®šã—ãŸæœˆé¡äºˆç®—ã«å¯¾ã—ã¦ã€å®Ÿç¸¾ã‚³ã‚¹ãƒˆãŒæŒ‡å®šã—ãŸæ•·å±…å€¤(%ã¾ãŸã¯çµ¶å¯¾å€¤)ã‚’è¶…ãˆãŸå ´åˆã‚„ã€è¶…ãˆã‚‹ã“ã¨ãŒäºˆæ¸¬ã•ã‚Œã‚‹å ´åˆã«é€šçŸ¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

![aws-budget-alert](/images/costmanagement/aws-budget-alert.png)

### Amazon Athena ã‚’åˆ©ç”¨ã—ã¦å¯è¦–åŒ–ã™ã‚‹

[Amazon Athena ã‚’ä½¿ç”¨ã—ãŸã‚³ã‚¹ãƒˆã¨ä½¿ç”¨çŠ¶æ³ãƒ¬ãƒãƒ¼ãƒˆã®ã‚¯ã‚¨ãƒª](https://docs.aws.amazon.com/ja_jp/cur/latest/userguide/cur-query-athena.html)

[AWS ãƒ–ãƒ­ã‚° - Amazon Athena ã‚’ä½¿ç”¨ã—ã¦ AWS Cost and Usage Report ã‚’ã‚¯ã‚¨ãƒªã™ã‚‹](https://aws.amazon.com/jp/blogs/news/querying-your-aws-cost-and-usage-report-using-amazon-athena/)

åŸºæœ¬çš„ãªæ§‹æˆã¯ç”¨æ„ã•ã‚Œã¦ã„ã‚‹ CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§è‡ªå‹•çš„ã«æ§‹ç¯‰ã•ã‚Œã¾ã™ã€‚

![cur-athena](/images/costmanagement/cur-athena.png)

ãã®å¾Œã€æ‰‹å‹•ã§ Athena ã§ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚[â‡’Athena ã®æ‰‹å‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](https://docs.aws.amazon.com/ja_jp/cur/latest/userguide/cur-ate-manual.html)

æ‰‹é †é€šã‚Šãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã¾ã§å®Œäº†ã—ãŸã‚‰ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ã‚³ã‚¹ãƒˆã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```sql
// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèªã€READY ã«ãªã£ã¦ã„ã‚Œã°ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã§ãã¾ã™
select status from cost_and_usage_data_status;

// 2022å¹´ã®æœˆé¡ã‚³ã‚¹ãƒˆã‚’AWSã‚µãƒ¼ãƒ“ã‚¹æ¯ï¼ˆline_item_product_codeï¼‰ã«è¡¨ç¤ºã™ã‚‹
SELECT line_item_product_code,
sum(line_item_blended_cost) AS cost, month
FROM mycostandusage_parquet
WHERE year='2022'
GROUP BY  line_item_product_code, month
HAVING sum(line_item_blended_cost) > 0
ORDER BY  line_item_product_code;

// ã‚³ã‚¹ãƒˆãŒé«˜ã„ EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æŠ½å‡ºã™ã‚‹
SELECT line_item_resource_id AS instance_id,
sum(line_item_unblended_cost) AS cost
FROM mycostandusage_parquet
WHERE year='2022' AND month='12'
  AND line_item_product_code = 'AmazonEC2'
  AND regexp_like(line_item_operation, 'RunInstance')
  AND regexp_like(line_item_resource_id, 'i-')
GROUP BY  line_item_resource_id
HAVING sum(line_item_unblended_cost) > 100
ORDER BY  cost desc
```

ã‚«ãƒ©ãƒ ã«ã¤ã„ã¦ã¯ã€[ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ã‚¯ã‚·ãƒ§ãƒŠãƒª](https://docs.aws.amazon.com/ja_jp/cur/latest/userguide/data-dictionary.html)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

ãŸã ã—ã€æ¬¡ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã¯ã€Athena ã ã¨ `line_item_product_code` ã¨ãªã‚‹ãŸã‚æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚

![cur-athena-dd](/images/costmanagement/cur-athena-dd.png)

- line_item_usage_account_id: AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ ID
- line_item_product_code: AWS ã‚µãƒ¼ãƒ“ã‚¹å
- line_item_resource_id: ãƒªã‚½ãƒ¼ã‚¹ ID
- line_item_operation: ã‚³ã‚¹ãƒˆãŒç™ºç”Ÿã—ãŸ API æ“ä½œ
- line_item_type: æ–™é‡‘ã‚¿ã‚¤ãƒ—
- line_item_unblended_cost: å®Ÿã‚³ã‚¹ãƒˆ
- year: è«‹æ±‚å¹´
- month: è«‹æ±‚æœˆ

ã•ã‚‰ã«ã€Amazon QuickSight ã‚’åˆ©ç”¨ã—ã¦å¯è¦–åŒ–ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

[Amazon ã¸ã®ãƒ¬ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ Amazon ã¸ã®ãƒ¬ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã®ãƒ­ãƒ¼ãƒ‰ QuickSight](https://docs.aws.amazon.com/ja_jp/cur/latest/userguide/cur-query-other.html#cur-query-other-qs)

[Analyzing AWS Billing Data Using Amazon Quicksight(YouTube)](https://www.youtube.com/watch?v=2JnfuAA-TiU)

[AWS Blog-Query and Visualize AWS Cost and Usage Data Using Amazon Athena and Amazon QuickSight](https://aws.amazon.com/jp/blogs/big-data/query-and-visualize-aws-cost-and-usage-data-using-amazon-athena-and-amazon-quicksight/)

![cur-quicksight](/images/costmanagement/cur-quicksight.png)

### AWS Cost Categories

[AWS Cost Categories](https://aws.amazon.com/jp/aws-cost-management/aws-cost-categories/)

### ã‚³ã‚¹ãƒˆåˆ†é…ã‚¿ã‚°

[AWS ã‚³ã‚¹ãƒˆé…åˆ†ã‚¿ã‚°ã®ä½¿ç”¨](https://docs.aws.amazon.com/ja_jp/awsaccountbilling/latest/aboutv2/cost-alloc-tags.html)

## ã‚³ã‚¹ãƒˆå‰Šæ¸›ãƒã‚¤ãƒ³ãƒˆ
